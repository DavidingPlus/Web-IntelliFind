import{_ as w}from"./PageContainer-634a4ae5.js";import{a as U,r as u,b as c,x as h,w as s,e as n,c as i,h as d,z as f,_ as l,as as k,a5 as x,m as S,aw as A,ax as B,p as E,i as I,d as R}from"./index-bed6c77c.js";/* empty css                  *//* empty css                    */import{_ as b}from"./default-1c45cdbd.js";/* empty css                   */import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";const C=r=>(E("data-v-170312fe"),r=r(),I(),r),D=["src"],N={key:1,src:b,class:"avatar"},V=C(()=>R("br",null,null,-1)),$={__name:"UserAvatar",setup(r){const _=U(),t=u(),o=u(_.user.user_pic),m=a=>{if(!a.raw){console.error("未选择图片");return}t.value=a.raw;const e=new FileReader;e.readAsDataURL(a.raw),e.onload=()=>{o.value=e.result}},v=async()=>{if(!t.value){l.error("请选择图片");return}const a=new FormData;a.append("avatar",t.value);try{await k(a),_.getUser(),l.success("头像更新成功")}catch(e){console.error("更新头像失败:",e),l.error("更新头像失败，请稍后重试")}};return(a,e)=>{const y=x,p=S,g=w;return c(),h(g,{title:"更换头像"},{default:s(()=>[n(y,{type:"file",ref_key:"uploadRef",ref:t,"auto-upload":!1,class:"avatar-uploader","show-file-list":!1,"on-change":m},{default:s(()=>[o.value?(c(),i("img",{key:0,src:o.value,class:"avatar"},null,8,D)):(c(),i("img",N))]),_:1},512),V,n(p,{onClick:e[0]||(e[0]=q=>t.value.$el.querySelector("input").click()),type:"primary",icon:f(A),size:"large"},{default:s(()=>[d("选择图片")]),_:1},8,["icon"]),n(p,{onClick:v,type:"success",icon:f(B),size:"large"},{default:s(()=>[d("上传头像")]),_:1},8,["icon"])]),_:1})}}},J=z($,[["__scopeId","data-v-170312fe"]]);export{J as default};
