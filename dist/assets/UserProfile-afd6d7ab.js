import{a as G,r as d,b as y,x as $,w as t,aq as q,d as c,e as l,h as i,c as k,z as S,ar as z,_,as as F,j as P,k as T,at as C,au as A,av as N,m as j,q as M,a5 as L,aw as Y,ax as H,p as J,i as K}from"./index-bed6c77c.js";/* empty css                  *//* empty css                    *//* empty css                     *//* empty css                     */import{_ as O}from"./default-1c45cdbd.js";import{_ as Q}from"./PageContainer-634a4ae5.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                   */const X=m=>(J("data-v-e0f386d8"),m=m(),K(),m),Z={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ee={style:{flex:"1"}},ae={style:{flex:"1","text-align":"center"}},le=["src"],te={key:1,src:O,class:"avatar"},oe=X(()=>c("br",null,null,-1)),re={__name:"UserProfile",setup(m){const p=G(),V=d(),n=d(),f=d(p.user.user_pic),a=d({user_name:"蓬鱼咽",email:"9517538462@pp.com",city:"山河四省",Birthday:"2056-10-10",Tel:"123456789",Gender:"男",avatar:"",create_time:"2021-10-10"}),b=r=>{const e=new Date(r),u=e.getFullYear(),s=(1+e.getMonth()).toString().padStart(2,"0"),v=e.getDate().toString().padStart(2,"0");return`${u}-${s}-${v}`},x=d({user_name:[{required:!0,message:"请输入用户姓名",trigger:"blur"},{pattern:/^\S{2,10}/,message:"用户姓名长度在2-10个非空字符",trigger:"blur"}],Tel:[{required:!0,message:"请输入电话号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的电话号码",trigger:"blur"}]}),U=async()=>{const{data:r}=await q();a.value=r.data,p.user.user_pic=r.data.avatar,a.value.create_time=b(r.data.create_time),console.log(a.value)},h=async()=>{await V.value.validate(),a.value.Birthday=b(a.value.Birthday),console.log(a.value),await z(a.value),U(),_.success("修改成功")},B=r=>{if(!r.raw){console.error("未选择图片");return}n.value=r.raw;const e=new FileReader;e.readAsDataURL(r.raw),e.onload=()=>{f.value=e.result}},E=async()=>{if(!n.value){_.error("请选择图片");return}const r=new FormData;r.append("avatar",n.value);try{await F(r),p.getUser(),_.success("头像更新成功")}catch(e){console.error("更新头像失败:",e),_.error("更新头像失败，请稍后重试")}};return U(),(r,e)=>{const u=P,s=T,v=C,w=A,R=N,g=j,D=M,I=L;return y(),$(Q,{title:"基本资料"},{default:t(()=>[c("div",Z,[c("div",ee,[l(D,{ref_key:"formRef",ref:V,model:a.value,rules:x.value,"label-width":"100px"},{default:t(()=>[l(s,{label:"用户姓名"},{default:t(()=>[l(u,{modelValue:a.value.user_name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.user_name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(s,{label:"所在城市"},{default:t(()=>[l(u,{modelValue:a.value.city,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.city=o),placeholder:"请输入所在城市"},null,8,["modelValue"])]),_:1}),l(s,{label:"生日"},{default:t(()=>[l(v,{modelValue:a.value.Birthday,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.Birthday=o),type:"date",placeholder:"请选择日期"},null,8,["modelValue"])]),_:1}),l(s,{label:"性别"},{default:t(()=>[c("div",null,[l(R,{modelValue:a.value.Gender,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.Gender=o)},{default:t(()=>[l(w,{label:"男",size:"large"},{default:t(()=>[i(" 男 ")]),_:1}),l(w,{label:"女",size:"large"},{default:t(()=>[i(" 女 ")]),_:1})]),_:1},8,["modelValue"])])]),_:1}),l(s,{label:"电话"},{default:t(()=>[l(u,{modelValue:a.value.Tel,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.Tel=o),placeholder:"请输入电话号码"},null,8,["modelValue"])]),_:1}),l(s,{label:"用户邮箱"},{default:t(()=>[l(u,{modelValue:a.value.email,"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.email=o),disabled:""},null,8,["modelValue"])]),_:1}),l(s,{label:"注册时间"},{default:t(()=>[l(u,{modelValue:a.value.create_time,"onUpdate:modelValue":e[6]||(e[6]=o=>a.value.create_time=o),disabled:""},null,8,["modelValue"])]),_:1}),l(s,null,{default:t(()=>[l(g,{type:"primary",onClick:h},{default:t(()=>[i("提交修改")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),c("div",ae,[l(I,{type:"file",ref_key:"uploadRef",ref:n,"auto-upload":!1,class:"avatar-uploader","show-file-list":!1,"on-change":B},{default:t(()=>[f.value?(y(),k("img",{key:0,src:f.value,class:"avatar"},null,8,le)):(y(),k("img",te))]),_:1},512),oe,l(g,{onClick:e[7]||(e[7]=o=>n.value.$el.querySelector("input").click()),type:"primary",icon:S(Y),size:"large"},{default:t(()=>[i("选择图片")]),_:1},8,["icon"]),l(g,{onClick:E,type:"success",icon:S(H),size:"large"},{default:t(()=>[i("上传头像")]),_:1},8,["icon"])])])]),_:1})}}},fe=W(re,[["__scopeId","data-v-e0f386d8"]]);export{fe as default};
