import{a as G,r as i,b as y,x as $,w as t,aq as q,d as m,e as l,h as c,c as k,z as S,ar as z,Z as f,as as F,j as P,k as T,at as C,au as A,av as N,m as j,q as M,a4 as L,aw as Y,ax as Z,p as H,i as J}from"./index-a9c24727.js";/* empty css                  *//* empty css                    *//* empty css                     *//* empty css                     */import{_ as K}from"./default-1c45cdbd.js";import{_ as O}from"./PageContainer-0cbf34de.js";/* empty css                   */import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";const W=_=>(H("data-v-1cec717b"),_=_(),J(),_),X={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ee={style:{flex:"1"}},ae={style:{flex:"1","text-align":"center"}},le=["src"],te={key:1,src:K,class:"avatar"},oe=W(()=>m("br",null,null,-1)),re={__name:"UserProfile",setup(_){const p=G(),b=i(),n=i(),d=i(p.user.user_pic),a=i({user_name:"蓬鱼咽",email:"9517538462@pp.com",city:"山河四省",Birthday:"2056-10-10",Tel:"123456789",Gender:"男",avatar:"",create_time:"2021-10-10"}),V=r=>{const e=new Date(r),u=e.getFullYear(),s=(1+e.getMonth()).toString().padStart(2,"0"),v=e.getDate().toString().padStart(2,"0");return`${u}-${s}-${v}`},x=i({user_name:[{required:!0,message:"请输入用户姓名",trigger:"blur"},{pattern:/^\S{2,10}/,message:"用户姓名长度在2-10个非空字符",trigger:"blur"}],Tel:[{required:!0,message:"请输入电话号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的电话号码",trigger:"blur"}]}),w=async()=>{const{data:r}=await q();a.value=r.data,p.user.user_pic="/www/wwwroot/backend/public"+r.data.avatar,console.log(p.user.user_pic),a.value.create_time=V(r.data.create_time),console.log(a.value)},h=async()=>{await b.value.validate(),a.value.Birthday=V(a.value.Birthday),console.log(a.value),await z(a.value),w(),f.success("修改成功")},B=r=>{if(!r.raw){console.error("未选择图片");return}n.value=r.raw;const e=new FileReader;e.readAsDataURL(r.raw),e.onload=()=>{d.value=e.result}},E=async()=>{if(!n.value){f.error("请选择图片");return}const r=new FormData;r.append("avatar",n.value);try{await F(r),p.user.user_pic=d.value,console.log(d.value),f.success("头像更新成功")}catch(e){console.error("更新头像失败:",e),f.error("更新头像失败，请稍后重试")}};return w(),(r,e)=>{const u=P,s=T,v=C,U=A,R=N,g=j,D=M,I=L;return y(),$(O,{title:"基本资料"},{default:t(()=>[m("div",X,[m("div",ee,[l(D,{ref_key:"formRef",ref:b,model:a.value,rules:x.value,"label-width":"100px"},{default:t(()=>[l(s,{label:"用户姓名"},{default:t(()=>[l(u,{modelValue:a.value.user_name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.user_name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(s,{label:"所在城市"},{default:t(()=>[l(u,{modelValue:a.value.city,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.city=o),placeholder:"请输入所在城市"},null,8,["modelValue"])]),_:1}),l(s,{label:"生日"},{default:t(()=>[l(v,{modelValue:a.value.Birthday,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.Birthday=o),type:"date",placeholder:"请选择日期"},null,8,["modelValue"])]),_:1}),l(s,{label:"性别"},{default:t(()=>[m("div",null,[l(R,{modelValue:a.value.Gender,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.Gender=o)},{default:t(()=>[l(U,{label:"男",size:"large"},{default:t(()=>[c(" 男 ")]),_:1}),l(U,{label:"女",size:"large"},{default:t(()=>[c(" 女 ")]),_:1})]),_:1},8,["modelValue"])])]),_:1}),l(s,{label:"电话"},{default:t(()=>[l(u,{modelValue:a.value.Tel,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.Tel=o),placeholder:"请输入电话号码"},null,8,["modelValue"])]),_:1}),l(s,{label:"用户邮箱"},{default:t(()=>[l(u,{modelValue:a.value.email,"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.email=o),disabled:""},null,8,["modelValue"])]),_:1}),l(s,{label:"注册时间"},{default:t(()=>[l(u,{modelValue:a.value.create_time,"onUpdate:modelValue":e[6]||(e[6]=o=>a.value.create_time=o),disabled:""},null,8,["modelValue"])]),_:1}),l(s,null,{default:t(()=>[l(g,{type:"primary",onClick:h},{default:t(()=>[c("提交修改")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),m("div",ae,[l(I,{type:"file",ref_key:"uploadRef",ref:n,"auto-upload":!1,class:"avatar-uploader","show-file-list":!1,"on-change":B},{default:t(()=>[d.value?(y(),k("img",{key:0,src:d.value,class:"avatar"},null,8,le)):(y(),k("img",te))]),_:1},512),oe,l(g,{onClick:e[7]||(e[7]=o=>n.value.$el.querySelector("input").click()),type:"primary",icon:S(Y),size:"large"},{default:t(()=>[c("选择图片")]),_:1},8,["icon"]),l(g,{onClick:E,type:"success",icon:S(Z),size:"large"},{default:t(()=>[c("上传头像")]),_:1},8,["icon"])])])]),_:1})}}},fe=Q(re,[["__scopeId","data-v-1cec717b"]]);export{fe as default};
